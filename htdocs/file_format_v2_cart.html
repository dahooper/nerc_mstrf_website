<HTML lang="en">
<HEAD>
<META name="keywords"
      content="MST, VHF, Doppler, radar, wind, profiler, wave, turbulence">
<META name="description"
      content="NERC MST Radar Facility at Aberystwyth">
<META name="author" Content="David Hooper">
<META name="Generator" Content="emacs">
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<LINK rel="stylesheet" type="text/css" href="nerc_mstrf_style.css">
<TITLE>File format for v2 Cartesian data</TITLE>
</HEAD>

<BODY leftmargin="0" marginheight="0" topmargin="0">
<A name="top">
<TABLE align="center" border="0"
       cellpadding="0" cellspacing="0" width="100%">
  <TR><TD bgcolor="#ffd000">
    <IMG height="5" src="FIGS/pixel_gold.png"></TD></TR>
</TABLE>

<TABLE align="center" bgcolor="#ffffff" border="0" cellpadding="0" 
       cellspacing="0" width="100%">
  <TR>
    <TD align="center" bgcolor="#ffd000" rowspan="5" width="170" valign="top">
      <IMG alt="NERC Logo" border="0" src="LOGOS/nerc_button.png">
      <IMG alt="MSTRF Logo" border="0" src="LOGOS/mst_button.png"><BR><BR>
      <A class="menu_avail" href="index.html">HOME</A><BR><BR>
      <A class="menu_avail" href="announcements.html">ANNOUNCEMENTS</A><BR><BR>
      <A class="menu_avail" href="contacts.html">CONTACTS</A><BR><BR>
      <A class="menu_avail" href="data.html">DATA</A><BR><BR>
      <A class="menu_avail" href="instruments.html">INSTRUMENTS</A><BR><BR>
      <A class="menu_avail" href="main_menu.html">MAIN MENU</A><BR><BR>
      <A class="menu_avail" href="miscellaneous.html">MISCELLANEOUS</A><BR><BR>
      <A class="menu_avail" href="plots.html">PLOTS</A><BR><BR>
      <A class="menu_avail" href="publications.html">PUBLICATIONS</A><BR><BR>
      <A class="menu_avail" href="science.html">SCIENCE</A><BR><BR>
      <A class="menu_avail" href="wind_prof_prin.html">
        WIND-PROFILER<BR>PRINCIPLES</A><BR><BR><BR>
      <B>For this page:</B><BR>
      <A class="menu_avail" href="#internal">INTERNAL LINKS</A><BR><BR>
      <A class="menu_avail" href="#external">EXTERNAL LINKS</A><BR>
    </TD>

    <TD align="left" bgcolor="#ffd000" colspan="2" height="41" valign="top">
      <B>THE NERC MST RADAR FACILITY AT ABERYSTWYTH</B><BR>
      <DIV class="current">FILE FORMAT FOR VERSION-2 MST RADAR CARTESIAN DATA
        </DIV>
    </TD>
  </TR>

  <TR><TD align="centre" bgcolor="#ffffff" colspan="2" valign="top">
    <IMG height="3" src="FIGS/pixel_white.png"></TD>
  </TR>

  <TR>
    <TD align="left" width="10" valign="top">
      <IMG src="FIGS/pixel_white.png">
    </TD>

    <TD align="left" valign="top">
<!*** Page contents to go here ***>
<B>WARNING: Version-2 MST radar data products are DEPRECATED</B><BR>
Users are encouraged to make use of <A
href="file_format_v3_cartesian.html">version-3 Cartesian files</A>.<BR>
<A href="sig_proc_version_nrs.html">Click here</A> to find out about
earlier versions of the signal processing.<BR><BR>

<B>File contents</B><BR>
The files contain altitude profiles (from approximately 2 - 20 km for
the ST mode, and from approximately 58 - 96 km for the M mode, both at
150 m intervals) of the eastward, northward and upward components of
the wind velocity and the following radar return parameters: vertical
beam signal power, aspect sensitivity, spectral width and
beam-broadening corrected spectral width. The time separation between
the profiles is typically a few minutes. A radar-derived tropopause
altitude and sharpness is given for each set of profiles. <BR>
<A href="file_contents.html">Click here</A> to find out about the
contents of other files.<BR><BR>

<B>File naming convention: </B><BR>

<CENTER><FONT
class="code_black">radar-mst_capel-dewi_YYYYMMDD_AARRR_cart_v2.na</FONT></CENTER><BR>

<TABLE bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0">
  <TR>
    <TD><IMG width="20" src="FIGS/pixel_white.png"></TD>
    <TD valign="top"><FONT class="code_black">YYYY</FONT></TD>
    <TD><IMG width="20" src="FIGS/pixel_white.png"></TD>
    <TD valign="top">is a 4-digit year [1990 - ]</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD valign="top"><FONT class="code_black">MM</FONT></TD>
    <TD></TD>
    <TD valign="top">is a 2-digit month [01 - 12]</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD valign="top"><FONT class="code_black">DD</FONT></TD>
    <TD></TD>
    <TD valign="top">is a 2-digit day [01 - 31]</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD valign="top"><FONT class="code_black">AA</FONT></TD>
    <TD></TD>
    <TD valign="top">is the altitude mode [<FONT
class="code_black">'st'</FONT>: approximately 2 - 20 km | <FONT
class="code_black">'m'</FONT>: approximately 58 - 96 km]</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD valign="top"><FONT class="code_black">RRR</FONT></TD>
    <TD></TD>
    <TD valign="top">is the range resolution (m) [150 | 300 | 600 |
    1200 | 2400 | 4800]</TD>
  </TR>
</TABLE>
i.e. <FONT class="code_black">radar-mst_capel-dewi_20050101_st300_cart_v2.na
</FONT> contains 300 m resolution Cartesian data over the ST altitude
    range for 1st January 2005.<BR>
<A href="file_naming_conventions.html">Click here</A> for the background to the
file naming convention.<BR><BR>

<B>File location: </B><A
  href="http://badc.nerc.ac.uk/getdata/data_browser/badc/mst/data/mst-products-v2/cartesian"><FONT
  class="code_black">/badc/mst/data/mst-products-v2/cartesian/</FONT></A><BR>
<A href="data_locations.html">Click here</A> for the location of other files.<BR><BR>


<B>Archiving convention: </B><FONT class="code_black">YYYY/MM</FONT><BR>
<A href="archiving_conventions.html">Click here</A> for a further explanation.<BR><BR>

<B>Data availability:</B> refer to <A
href="cgi-bin/mstlog_public/mst_event_search.py">Instrument
performance weblog</A><BR><BR>

<B>File format</B><BR>
NASA-Ames files, with a File Format Index of 2110, are used, i.e. the
same as for <A href="file_format_v1_cart.html">Version-1 data
products</A>. However, there are some small differences in the file
contents. Users will therefore need to make a few modifications to any
software designed for dealing with Version-1 products. <BR><BR> 

Only those aspects of the file format which are essential for reading
the data will be described. For a full description of the NASA-Ames
formats, consult the <A href="
http://badc.nerc.ac.uk/help/formats/NASA-Ames/G-and-H-June-1998.html">Gaines
and Hipskind [1998]</A> document.<BR><BR>

The Cartesian file for 1st January 2005 will be used as an example. Text
in green represents actual file contents. Text in red is for
explanatory purposes only.<BR>


<DL><B>Header Lines</B>
  <DD><B>Line 1: </B><FONT class="code_green">95 2110</FONT><BR>
    Integer 1 corresponds to the total number of header lines,
    <FONT class="code_red">nr_header_lines</FONT><BR>
    Integer 2 corresponds to the File Format Index<BR><BR>

  <DD><B>Line 7: </B><FONT class="code_green">2005 01 01 2005 01 10</FONT><BR>
    Integers 1 - 3 correspond to the year, month and day on which the
    observations were made.<BR>
    Integers 4 - 6 correspond to the year, month and day on which the
    file was created.<BR><BR>

  <DD><B>Line 11: </B><FONT class="code_green">14</FONT><BR>
    The number of primary variables (<FONT
    class="code_red">nr_primary_vars</FONT>).<BR><BR>

   <A name="line13">
  <DD><B>Line 13: </B><FONT class="code_green">9999.99 9999.99 99999 99 999.999 99999 999.99 99999 999.99 99999 99.999 99999 99.999 99999</FONT><BR>
    Missing data values, in order, for the <FONT
    class="code_red">nr_primary_vars</FONT> primary variables <A
    href="#primary">listed below</A>. Greater use is made
    of missing data values than in the Version-1 files and so users should make
    sure that they make the appropriate substitutions when they read
    in the data.<BR><BR>

  <DD><B>Lines 14 - 27</B><BR>
    The names of the primary variables (<A
    href="#primary">listed below</A>)<BR><BR>

  <DD><B>Line 40: </B><FONT class="code_green">130 366</FONT><BR>
    Integer 1 corresponds to the number of altitude gates per cycle,
     <FONT class="code_red">nr_gates</FONT><BR>
    Integer 2 corresponds to the number of cycles in the file,
     <FONT class="code_red">nr_cycles</FONT><BR><BR>

  <DD><B>Lines 41 - 66: </B><BR>
    Data product definitions - this
    information is shown, further down the page, in association with the
    relevant primary variables.<BR><BR>

  <DD><B>Lines 67 - 93: </B><BR>
    Global data attributes following the netCDF CF 1.0
    convention. This includes a processing history. It is not
    necessary to know this information in order to read the file.
  </DL>

<B>Data reading loop</B><BR>

After reading the above mentioned lines, wind forward to line <FONT
class="code_red">(nr_header_lines + 1)</FONT> where the data
begin. Associated with each cycle of observation there is a single
line of auxiliary variables followed by <FONT
class="code_red">nr_gates</FONT> lines of primary variables. The data
can therefore be read with a simple loop structure of the form (shown
here in Fortran syntax):<BR>

<PRE><FONT class="code_red">do cycle_nr = 1,nr_cycles
  read_auxiliary_variables
  do gate_nr = 1,nr_gates
    read_primary_variables
  end do
end do</FONT></PRE>

<B>Reading auxiliary variables</B><BR>

Each auxiliary variables line contains 5 integers (the second
independent variable followed by the 4 auxilliary variables) shown
here for the first cycle in the file:
<PRE><FONT class="code_green">116 130 1 11086 3</FONT></PRE>

<DL>
  <DD><B>Integer 1: Cycle time (s)</B><BR>
    Technically speaking this is the second independent variable
    rather than an auxiliary variable. The time is given in seconds
    since 00:00:00 UTC for the day in question.<BR><BR>

  <DD><B>Integer 2: Number of range gates</B><BR>
    This is the same as <FONT class="code_red">nr_gates</FONT> given in
    line 40 of the header and so can be ignored.<BR><BR>

  <DD><B>Integer 3: Cycle number</B><BR>
    This is the same as <FONT class="code_red">cycle_nr</FONT> used in the
    data reading loop and so can be ignored.<BR><BR>

  <DD><B>Integer 4: Tropopause altitude (m)</B><BR>
    This is the altitude of the (static stability) tropopause, in
    metres above mean sea level, determined from the altitude profile
    of the vertical beam signal strength.<BR><BR>

  <DD><B>Integer 5: Tropopause sharpness factor</B><BR>

<TABLE bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0">
  <TR>
    <TD>0</TD>
    <TD><IMG width="20" src="FIGS/pixel_white.png"></TD>
    <TD valign="top">corresponds to an indefinite tropopause</TD>
  </TR>
  <TR>
    <TD>1</TD>
    <TD></TD>
    <TD valign="top">corresponds to lower-intermediate sharpness</TD>
  </TR>
  <TR>
    <TD>2</TD>
    <TD></TD>
    <TD valign="top">corresponds to upper-intermediate sharpness</TD>
  </TR>
  <TR>
    <TD>3</TD>
    <TD></TD>
    <TD valign="top">corresponds to a definite tropopause</TD>
  </TR>
</TABLE>
It should be noted that the altitude can have little significance for
a poorly defined tropoapuse, i.e. for low values of the sharpness
factor.
</DL>

<A name="primary">
<B>Reading primary variables</B><BR> 
These lines contain 15 values: the first independent variable (altitude)
followed by the 14 primary variables, as shown below for the first
line of the first cycle. These are a mixture of floating
point, <FONT class="code_red">F</FONT>, and integer, <FONT
class="code_red">I</FONT> values. <BR>

<FONT class="code_green">1686.0   16.13   -3.36 32799  7   0.116 32771 57.82 32771   4.19 32771  0.309 32771  0.169 32771</FONT><BR>


<DL>
  <DD><B>Value 1: Altitude (m)</B> <FONT class="code_red">F</FONT><BR>
    Technically speaking this is the first independent variable rather
    than a primary variable. Therefore it does not have a missing data
    value defined in <A href="#line13">line 13</A> of the
    header. Missing data values 1 - 14 therefore correspond to values
    2 - 15 on the primary variable data line. The same altitude grid
    is used for all cycles and so only needs to be saved once. The
    altitude is given in metres above mean sea level.<BR><BR>

  <DD><B>Value 2: Eastward wind (m s-1)</B> <FONT class="code_red">F</FONT><BR>
    or zonal velocity<BR><BR>

  <DD><B>Value 3: Northward wind (m s-1)</B> <FONT class="code_red">F</FONT><BR>
    or meridional velocity<BR><BR>

  <DD><B>Value 4: Horizontal wind reliability flag</B> 
    <FONT class="code_red">I</FONT><BR>
    This applies to both the eastward and northward components of the
    wind. The way in which information is recorded in the reliability
    flag values is different to that used in Version-1 files. However,
    the same convention is used for all reliability flags in the
    Version-2 files - <A href="#rel_flag">see below </A><BR><BR>

  <DD><B>Value 5: Complementary beam horizontal velocity variability factor (m s-1)</B> <FONT class="code_red">I</FONT><BR>

    In the standard-mode, the MST radar makes observations
    in the Vertical, NE6, SE6, SW6 and NW6 beam directions. The NE
    component of the horizontal wind can therefore be derived from the
    Vertical/NE6 or Vertical/SW6 beam pair combinations. Similarly the
    SE component can be derived from the Vertical/SE6 or Vertical/NW6
    combinations. The variability factor is defined as the root of the
    sum of the squares of the differences between the estimates in the
    NE and SE azimuths. A small value - less than 5 m/s - indicates
    that that the different wind estimates are consistent. Larger
    values - greater than 10 m/s - indicate that they are not and this
    fact is recorded in <A href="#rel_flag">an enhanced data
    reliability flag</A>.<BR><BR>

  <DD><B>Value 6: Upward air velocity (m s-1)</B>
    <FONT class="code_red">F</FONT><BR>
    Note that this value can be biased for a number of reasons and
    should be interpreted as being representative rather than
    necessarily as quantitatively accurate. In particular, little
    significance should be attached to values of less than
    approximately 0.1 m/s. Absolute values of the order of 1 m/s give
    a reliable indication of the presence of mountain wave or convective
    activity.<BR><BR>

  <DD><B>Value 7: Upward air velocity reliability flag</B>
    <FONT class="code_red">I</FONT><BR>
    <A href="#rel_flag">See below </A><BR><BR>

  <DD><B>Value 8: Radar return signal power (dB)</B>
    <FONT class="code_red">F</FONT><BR>
     Corresponds to obervations made with a vertically directed beam.<BR>
     P_dB = 10 &times; log10[P_linear]<BR><BR>

  <DD><B>Value 9: Radar return signal power reliability flag</B>
    <FONT class="code_red">I</FONT><BR>
    <A href="#rel_flag">See below </A><BR><BR>

  <DD><B>Value 10: Radar return aspect sensitivity (dB)</B>
    <FONT class="code_red">F</FONT><BR>
    The ratio of radar return signal power for a vertically directed
    beam to that for a beam directed 6&deg; off-vertical.<BR><BR>

  <DD><B>Value 11: Radar return aspect sensitivity reliability flag</B>
    <FONT class="code_red">I</FONT><BR>
    <A href="#rel_flag">See below </A><BR><BR>

  <DD><B>Value 12: Radar return spectral width (m s-1)</B>
    <FONT class="code_red">F</FONT><BR>
    This is for observations made by a vertically directed beam and
    corresponds to to an e-1/2 half-width for a Gaussian shaped
    signal. Note these values need to corrected for the effects of
    beam-broadening before they can be interpreted in terms of
    turbulent activity.<BR><BR>

  <DD><B>Value 13: Radar return spectral width reliability flag</B>
    <FONT class="code_red">I</FONT><BR>
    <A href="#rel_flag">See below </A><BR><BR>

  <DD><B>Value 14: Beam-broadening corrected spectral width (m s-1)</B> <FONT class="code_red">F</FONT><BR>
    This is the highest order radar data product and is sensitive to
    errors and uncertainties in several lower order products. Care
    should therefore be taken with its interpretation. In principal it
    gives the standard deviation of turbulent velocities about the
    mean vertical velocity.<BR><BR>

  <DD><B>Value 15: Beam-broadening corrected spectral width reliability flag</B>
    <FONT class="code_red">I</FONT><BR>
    <A href="#rel_flag">See below </A><BR><BR>
</DL>

<A name="rel_flag">
<B>Data Reliability flags</B><BR>

The same convention is used for all reliability flags in the Version-2
files, although this differs from that used for <A
href="file_format_v1_cart.html">Version-1 files.</A> A larger range of
information is now stored bit-wise in a 16-bit integer, with the 15th
bit being used as an overall indicator of data reliability. Therefore
data may be regarded as reliable if:<BR><BR> 

<CENTER><FONT class="code_black">flag value &gt;=
32768</FONT></CENTER><BR>

The convention has been adopted so that more pieces of information can
be added to the flag value at a later date, without changing the
acceptance condition. At present, only 6 of the available 16 bits are
used:<BR><BR>

<TABLE bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0">
  <TR>
    <TD><IMG width="20" src="FIGS/pixel_white.png"></TD>
    <TD align="center" valign="top">Bit number</B></TD>
    <TD><IMG width="20" src="FIGS/pixel_white.png"></TD>
    <TD valign="top">Information</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD align="center">0</TD>
    <TD></TD>
    <TD valign="top">peak signal PSD to noise PSD &gt;= threshold value</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD align="center">1</TD>
    <TD></TD>
    <TD valign="top">time continuity threshold exceded</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD align="center">2</TD>
    <TD></TD>
    <TD valign="top">complementary beams are available</B>
  </TR>
  <TR>
    <TD></TD>
    <TD align="center">3</TD>
    <TD></TD>
    <TD valign="top">complementary beam factor &gt;= threshold value</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD align="center">4</TD>
    <TD></TD>
    <TD valign="top">complementary beam factor is significant</TD>
  </TR>
  <TR>
    <TD></TD>
    <TD align="center">15</TD>
    <TD></TD>
    <TD valign="top">overall reliability flag</TD>
  </TR>
</TABLE>
The threshold values used for a particular file are quoted in header
lines 56 - 61.
<BR><BR>

<!*** Links and references ***>
<A name="internal">
<DL><B>Internal Links:</B>
  <DD><A href="#top">Return to the top of the page</A>
  <DD><A href="data_access.html">Gaining access to the data</A>
  <DD><A href="file_naming_conventions.html">File naming convention</A>
  <DD><A href="archiving_conventions.html">Data archiving convention</A>
  <DD><A href="data_locations.html">Data locations</A>
  <DD><A href="sig_proc_version_nrs.html">The differences between
  signal processing versions</A>
  <DD><A href="file_contents.html">The contents of other data files</A>
</DL>

<A name="external">
<DL><B>External Links:</B>
  <DD><A href="
http://badc.nerc.ac.uk/help/formats/NASA-Ames/G-and-H-June-1998.html">Full
       description of the NASA-Ames formats: Gaines and Hipskind [1998]</A>

<!*** Close page ***>
    </TD>
  </TR>

  <TR><TD align="centre" bgcolor="#ffffff" colspan="2" valign="top">
    <IMG height="10" src="FIGS/pixel_white.png"></TD>
  </TR>

  <TR><TD align="left" bgcolor="#ffd000" colspan="2" valign="bottom">
    <I>Page maintained by <A href="mailto:D.A.Hooper@rl.ac.uk">
         David Hooper</A><BR>
       Last updated 9th November 2006</I>
  </TD></TR>
</TABLE>
</BODY>
</HTML>
